# THIS FILE IS GENERATED FROM src/openapi/spec.ts. DO NOT EDIT DIRECTLY.
components:
  responses:
    Error:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
      description: エラーが発生した場合のレスポンス
  schemas:
    AssignLabelRequest:
      properties:
        labelName:
          description: 付与するラベル名
          type: string
      required:
        - labelName
      type: object
    AssignLabelResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            label:
              $ref: "#/components/schemas/Label"
          required:
            - label
          type: object
    BatchLabelRequest:
      properties:
        articleIds:
          items:
            format: int64
            type: integer
          minItems: 1
          type: array
        description:
          nullable: true
          type: string
        labelName:
          type: string
      required:
        - articleIds
        - labelName
      type: object
    BatchLabelResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            errors:
              items:
                properties:
                  articleId:
                    format: int64
                    type: integer
                  error:
                    type: string
                required:
                  - articleId
                  - error
                type: object
              type: array
            label:
              $ref: "#/components/schemas/Label"
            skipped:
              format: int32
              type: integer
            successful:
              format: int32
              type: integer
          required:
            - successful
            - skipped
            - errors
            - label
          type: object
    Bookmark:
      properties:
        createdAt: &a1
          description: ISO 8601 形式の日時
          format: date-time
          type: string
        id: &a2
          example: 1
          format: int64
          type: integer
        isRead: &a5
          type: boolean
        title: &a4
          nullable: true
          type: string
        updatedAt: *a1
        url: &a3
          format: uri
          type: string
      required:
        - id
        - url
        - isRead
        - createdAt
        - updatedAt
      type: object
    BookmarkListResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              items:
                $ref: "#/components/schemas/BookmarkWithLabel"
              type: array
            todayReadCount:
              format: int64
              type: integer
            totalUnread:
              format: int64
              type: integer
          required:
            - bookmarks
          type: object
    BookmarkWithLabel:
      properties:
        createdAt: *a1
        id: *a2
        isFavorite:
          type: boolean
        isRead: *a5
        label:
          allOf:
            - $ref: "#/components/schemas/Label"
          nullable: true
        title: *a4
        updatedAt: *a1
        url: *a3
      required:
        - id
        - url
        - isRead
        - createdAt
        - updatedAt
        - isFavorite
      type: object
    BulkBookmarksRequest:
      properties:
        bookmarks:
          items:
            properties:
              title:
                type: string
              url:
                format: uri
                type: string
            required:
              - url
              - title
            type: object
          minItems: 1
          type: array
      required:
        - bookmarks
      type: object
    CreateLabelRequest:
      properties:
        description:
          nullable: true
          type: string
        name:
          type: string
      required:
        - name
      type: object
    DatabaseStatus:
      properties:
        articleLabelCount:
          type: integer
        bookmarkCount:
          type: integer
        favoriteCount:
          type: integer
        labelCount:
          type: integer
        lastUpdatedAt:
          format: date-time
          nullable: true
          type: string
        readCount:
          type: integer
        unreadCount:
          type: integer
      required:
        - bookmarkCount
        - labelCount
        - articleLabelCount
        - favoriteCount
        - unreadCount
        - readCount
        - lastUpdatedAt
      type: object
    DbTestResponse:
      oneOf:
        - properties:
            bookmarkCount:
              type: integer
            message:
              type: string
          required:
            - message
            - bookmarkCount
          type: object
        - properties:
            error:
              type: string
            message:
              type: string
          required:
            - message
            - error
          type: object
    DevTestResponse:
      properties:
        message:
          example: API is working!
          type: string
      required:
        - message
      type: object
    ErrorResponse:
      properties:
        message:
          type: string
        success:
          enum:
            - false
          type: boolean
      required:
        - success
        - message
      type: object
    FavoriteBookmarksResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              items:
                $ref: "#/components/schemas/BookmarkWithLabel"
              type: array
            total:
              format: int64
              type: integer
          required:
            - bookmarks
          type: object
    HealthResponse:
      properties:
        status:
          example: ok
          type: string
        timestamp: *a1
      required:
        - status
        - timestamp
      type: object
    Label:
      properties:
        createdAt: *a1
        description:
          nullable: true
          type: string
        id:
          example: 1
          format: int64
          type: integer
        name:
          description: 正規化済みのラベル名
          type: string
        updatedAt: *a1
      required:
        - id
        - name
        - createdAt
        - updatedAt
      type: object
    LabelCleanupResponse:
      allOf:
        - $ref: "#/components/schemas/MessageResponse"
        - properties:
            deletedCount:
              format: int32
              type: integer
            deletedLabels:
              items:
                $ref: "#/components/schemas/Label"
              type: array
          required:
            - deletedCount
            - deletedLabels
          type: object
    LabelResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            label:
              $ref: "#/components/schemas/Label"
          required:
            - label
          type: object
    LabelWithCount:
      allOf:
        - $ref: "#/components/schemas/Label"
        - properties:
            articleCount:
              format: int64
              type: integer
          required:
            - articleCount
          type: object
    LabelsResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            labels:
              items:
                $ref: "#/components/schemas/LabelWithCount"
              type: array
          required:
            - labels
          type: object
    MessageResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            message:
              type: string
          required:
            - message
          type: object
    RecentBookmarksResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              additionalProperties:
                items:
                  $ref: "#/components/schemas/BookmarkWithLabel"
                type: array
              description: YYYY-MM-DD をキーにした既読ブックマークリスト
              type: object
          required:
            - bookmarks
          type: object
    RecentBookmarksSampleResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              items:
                $ref: "#/components/schemas/BookmarkWithLabel"
              type: array
            count:
              type: integer
          required:
            - count
            - bookmarks
          type: object
    SeedClearResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            data:
              properties:
                cleared:
                  $ref: "#/components/schemas/SeedGeneratedCounts"
                executionTimeMs:
                  format: int64
                  type: integer
              required:
                - cleared
                - executionTimeMs
              type: object
            message:
              type: string
          required:
            - message
            - data
          type: object
    SeedGeneratedCounts:
      properties:
        articleLabels:
          type: integer
        bookmarks:
          type: integer
        favorites:
          type: integer
        labels:
          type: integer
      required:
        - bookmarks
        - labels
        - articleLabels
        - favorites
      type: object
    SeedOptions:
      properties:
        bookmarkCount:
          maximum: 100
          minimum: 1
          type: integer
        favoriteRatio:
          maximum: 1
          minimum: 0
          type: number
        forceRun:
          type: boolean
        labelCount:
          maximum: 20
          minimum: 1
          type: integer
      type: object
    SeedResult:
      properties:
        executionTimeMs:
          format: int64
          type: integer
        generated:
          $ref: "#/components/schemas/SeedGeneratedCounts"
        message:
          type: string
        success:
          type: boolean
      required:
        - success
        - message
        - generated
        - executionTimeMs
      type: object
    SeedRunResponse:
      oneOf:
        - allOf:
            - $ref: "#/components/schemas/SuccessResponse"
            - properties:
                data:
                  properties:
                    executionTimeMs:
                      format: int64
                      type: integer
                    generated:
                      $ref: "#/components/schemas/SeedGeneratedCounts"
                  required:
                    - generated
                    - executionTimeMs
                  type: object
                message:
                  type: string
              required:
                - message
                - data
              type: object
        - properties:
            error:
              type: string
            success:
              enum:
                - false
              type: boolean
          required:
            - success
            - error
          type: object
    SeedStatusResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            data:
              $ref: "#/components/schemas/DatabaseStatus"
          required:
            - data
          type: object
    SuccessResponse:
      properties:
        success:
          enum:
            - true
          type: boolean
      required:
        - success
      type: object
    UnlabeledBookmarksResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              items:
                $ref: "#/components/schemas/Bookmark"
              type: array
          required:
            - bookmarks
          type: object
    UnratedBookmarksResponse:
      allOf:
        - $ref: "#/components/schemas/SuccessResponse"
        - properties:
            bookmarks:
              items:
                $ref: "#/components/schemas/BookmarkWithLabel"
              type: array
          required:
            - bookmarks
          type: object
    UpdateLabelRequest:
      properties:
        description:
          nullable: true
          type: string
      required:
        - description
      type: object
info:
  description: |-
    ブックマーク管理を行う Yomimono API の OpenAPI 定義。
    このファイルは src/openapi/spec.ts を唯一のソースとして生成されます。
  title: Yomimono API
  version: 0.1.0
openapi: 3.1.0
paths:
  /api/bookmarks:
    get:
      parameters:
        - description: ラベル名でのフィルタ（正規化済みの値）
          in: query
          name: label
          required: false
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BookmarkListResponse"
          description: 未読またはラベルで絞ったブックマーク一覧
        "500":
          $ref: "#/components/responses/Error"
      summary: 未読ブックマーク一覧
      tags:
        - Bookmarks
  /api/bookmarks/batch-label:
    put:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BatchLabelRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BatchLabelResponse"
          description: ラベル付け結果
        "400":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: 複数記事にまとめてラベル付け
      tags:
        - Bookmarks
  /api/bookmarks/bulk:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkBookmarksRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
          description: 登録処理を実行
        "400":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ブックマーク一括登録
      tags:
        - Bookmarks
  /api/bookmarks/favorites:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FavoriteBookmarksResponse"
          description: お気に入りのブックマーク一覧
        "500":
          $ref: "#/components/responses/Error"
      summary: お気に入り一覧
      tags:
        - Bookmarks
  /api/bookmarks/recent:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecentBookmarksResponse"
          description: 日付ごとにグルーピングされた既読履歴
        "500":
          $ref: "#/components/responses/Error"
      summary: 最近既読にしたブックマーク
      tags:
        - Bookmarks
  /api/bookmarks/unlabeled:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnlabeledBookmarksResponse"
          description: 未ラベルのブックマーク一覧
        "500":
          $ref: "#/components/responses/Error"
      summary: 未ラベルの未読ブックマーク一覧
      tags:
        - Bookmarks
  /api/bookmarks/unrated:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnratedBookmarksResponse"
          description: 未評価のブックマーク一覧
        "500":
          $ref: "#/components/responses/Error"
      summary: 未評価のブックマーク一覧
      tags:
        - Bookmarks
  /api/bookmarks/{id}/favorite:
    delete:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
          description: お気に入りから削除
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: お気に入り削除
      tags:
        - Bookmarks
    post:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
          description: お気に入り登録完了
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "409":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: お気に入り追加
      tags:
        - Bookmarks
  /api/bookmarks/{id}/label:
    put:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssignLabelRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssignLabelResponse"
          description: 付与したラベルを返却
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "409":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ブックマークへラベルを付与
      tags:
        - Bookmarks
  /api/bookmarks/{id}/read:
    patch:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
          description: 既読化完了
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ブックマークを既読にする
      tags:
        - Bookmarks
  /api/bookmarks/{id}/unread:
    patch:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
          description: 未読へ戻した結果
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ブックマークを未読に戻す
      tags:
        - Bookmarks
  /api/dev/db-test:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DbTestResponse"
          description: DB 接続成功
        "500":
          $ref: "#/components/responses/Error"
      summary: DB 接続テスト
      tags:
        - Developer
  /api/dev/recent-bookmarks:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecentBookmarksSampleResponse"
          description: 最近のブックマーク
        "500":
          $ref: "#/components/responses/Error"
      summary: 最近追加したブックマーク確認
      tags:
        - Developer
  /api/dev/seed:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SeedOptions"
        required: false
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SeedRunResponse"
          description: 生成結果
        "500":
          $ref: "#/components/responses/Error"
      summary: シードデータを生成
      tags:
        - Developer
  /api/dev/seed/clear:
    post:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SeedClearResponse"
          description: クリア結果
        "500":
          $ref: "#/components/responses/Error"
      summary: DB をクリア
      tags:
        - Developer
  /api/dev/seed/custom:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SeedOptions"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SeedRunResponse"
          description: 生成結果
        "400":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: カスタムパラメータでシード生成
      tags:
        - Developer
  /api/dev/seed/status:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SeedStatusResponse"
          description: 現在のレコード数など
        "500":
          $ref: "#/components/responses/Error"
      summary: DB の状態を取得
      tags:
        - Developer
  /api/dev/test:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DevTestResponse"
          description: シンプルなテストレスポンス
      summary: API 動作確認用の簡易レスポンス
      tags:
        - Developer
  /api/labels:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LabelsResponse"
          description: ラベルと件数の一覧
        "500":
          $ref: "#/components/responses/Error"
      summary: ラベル一覧
      tags:
        - Labels
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateLabelRequest"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LabelResponse"
          description: 作成したラベル
        "400":
          $ref: "#/components/responses/Error"
        "409":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ラベル作成
      tags:
        - Labels
  /api/labels/cleanup:
    delete:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LabelCleanupResponse"
          description: 削除件数を返却
        "500":
          $ref: "#/components/responses/Error"
      summary: 未使用ラベルの一括削除
      tags:
        - Labels
  /api/labels/{id}:
    delete:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
          description: 削除完了メッセージ
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ラベル削除
      tags:
        - Labels
    get:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LabelResponse"
          description: 対象ラベル
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ID でラベル取得
      tags:
        - Labels
    patch:
      parameters:
        - in: path
          name: id
          required: true
          schema:
            format: int64
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateLabelRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LabelResponse"
          description: 更新後のラベル
        "400":
          $ref: "#/components/responses/Error"
        "404":
          $ref: "#/components/responses/Error"
        "500":
          $ref: "#/components/responses/Error"
      summary: ラベル説明文の更新
      tags:
        - Labels
  /health:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
          description: 稼働中
      summary: ヘルスチェック
      tags:
        - Developer
servers:
  - description: ローカル開発（wrangler dev）
    url: http://localhost:8787
  - description: 本番 API
    url: https://api-yomimono.workers.dev
tags:
  - description: ブックマーク関連の操作
    name: Bookmarks
  - description: ラベル関連の操作
    name: Labels
  - description: 開発・デバッグ向けエンドポイント
    name: Developer
