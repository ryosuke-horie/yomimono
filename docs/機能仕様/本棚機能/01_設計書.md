# 本棚機能設計書

## 概要
通常の技術記事とは別に、本・GitHub リポジトリ・PDF（論文）など、読むのに数時間以上を要する骨のある読み物を管理する「本棚」機能を実装する。

## 背景と目的

### 現状の課題
- 現在のブックマーク機能は短時間で読める技術記事に最適化されている
- 長編コンテンツ（本、論文、大規模リポジトリ）の管理には不向き
- 読書進捗の管理ができない
- コンテンツの種類に応じた整理ができない

### 目的
- 長時間かけて読むコンテンツの専用管理場所を提供
- 読書進捗の可視化
- コンテンツタイプ別の整理・検索機能
- 読書計画の立案支援

## 機能要件

### 1. コンテンツタイプ
以下の種類のコンテンツを管理可能にする：

| タイプ | 説明 | メタデータ |
|--------|------|------------|
| 📚 書籍 | 技術書、ビジネス書など | タイトル、表紙画像URL |
| 📄 PDF/論文 | 学術論文、技術文書 | タイトル、URL |
| 🐙 GitHubリポジトリ | ソースコード、ドキュメント | タイトル、URL |
| 📖 Zenn Book | Zennの本形式コンテンツ | タイトル、URL |

### 2. ステータス管理

```typescript
enum ReadingStatus {
  UNREAD = "unread",                 // 未読
  READING = "reading",               // 読書中
  COMPLETED = "completed"            // 読了
}
```

### 3. シンプルな管理
- ステータス管理のみ（未読・読書中・読了）
- 進捗の詳細管理は不要


## データモデル

### booksテーブル
```sql
CREATE TABLE books (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  type TEXT NOT NULL, -- 'book', 'pdf', 'github', 'zenn'
  title TEXT NOT NULL,
  url TEXT, -- PDF/GitHub/Zennの場合のURL
  image_url TEXT, -- 書籍の表紙画像URL
  status TEXT NOT NULL DEFAULT 'unread',
  completed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```




## API設計

### エンドポイント一覧

#### 本棚管理
- `GET /api/bookshelf` - 本棚の一覧取得
- `POST /api/bookshelf` - 本を追加
- `GET /api/bookshelf/:id` - 本の詳細取得
- `PUT /api/bookshelf/:id` - 本の情報更新
- `DELETE /api/bookshelf/:id` - 本を削除
- `PATCH /api/bookshelf/:id/status` - ステータス更新

## UI/UX設計

### 1. 本棚ページレイアウト

```
┌─────────────────────────────────────────────┐
│  📚 私の本棚                                │
├─────────────────────────────────────────────┤
│ [未読] [読書中] [読了]                       │
├─────────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────┐ ┌─────────┐      │
│ │ [表紙]  │ │ [表紙]  │ │  🐙     │      │
│ │ Book 1  │ │ PDF 1   │ │ Repo 1  │      │
│ │ 読書中  │ │ 読了    │ │ 未読    │      │
│ └─────────┘ └─────────┘ └─────────┘      │
└─────────────────────────────────────────────┘
```

### 2. 本の詳細ページ

```
┌─────────────────────────────────────────────┐
│  [表紙画像/アイコン]                         │
│  [タイトル]                                  │
├─────────────────────────────────────────────┤
│ タイプ: [書籍/PDF/GitHub/Zenn]              │
│ URL: [リンク] (PDF/GitHub/Zennの場合)        │
│                                             │
│ ステータス: [未読 ▼] [読書中 ▼] [読了 ▼]    │
└─────────────────────────────────────────────┘
```

### 3. 本の追加フォーム

```typescript
interface BookAddForm {
  type: BookType; // 'book' | 'pdf' | 'github' | 'zenn'
  title: string;
  url?: string; // PDF(Google Drive), GitHub, Zennの場合は必須
  imageUrl?: string; // 書籍の表紙画像URL
}
```

## 実装計画

### Phase 1: 基盤構築（MVP）
1. データベーススキーマの作成（booksテーブルのみ）
2. 基本的なCRUD API実装
3. シンプルな本棚ページUI
4. 本の追加・編集・削除機能
5. ステータス変更機能（未読・読書中・読了）

## 技術的考慮事項

### 1. 既存システムとの統合
- 現在のブックマーク機能とは独立して実装

### 2. パフォーマンス
- 個人利用のためパフォーマンス要件は考慮しない
- シンプルな実装を優先

### 3. 外部API連携
- Google Books API - タイトルから表紙画像URLを取得
  - エンドポイント: `https://www.googleapis.com/books/v1/volumes?q=intitle:書籍タイトル`
  - レスポンスの`imageLinks.thumbnail`から表紙画像URLを取得
  - 1日1000リクエストの制限あり
- GitHub API - リポジトリ情報の自動取得（OGP画像）

### 4. Chrome拡張機能との連携
- 現在開いているGitHubリポジトリを本棚に追加
- PDFファイルのURLを本棚に追加
- Zenn Bookを本棚に追加

